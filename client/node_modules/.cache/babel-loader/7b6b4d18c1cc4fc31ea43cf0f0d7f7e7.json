{"ast":null,"code":"var _jsxFileName = \"/home/amira/Bureau/copie-projet-chef-d-oeuvreV12/client/src/components/dashbordAdmin/gestion-admin.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { getAideFromDB } from \"../../actions/aideActionCreator\";\nimport { Pagination } from \"antd\";\nimport moment from \"moment\";\nimport { Redirect } from \"react-router-dom\";\nimport { getReservation, editDecisionInDB } from \"../../actions/reservationAction\";\nimport { getUser } from \"../../actions/auth\";\nimport { Label, Table, Button } from \"semantic-ui-react\";\nimport { MDBInput } from \"mdbreact\";\nimport axios from \"axios\";\nexport class GestionReserv extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      decision: \"Validée\",\n      deci: \"Annulée\",\n      devis: \"\",\n      page: 1,\n      pageSize: 3\n    };\n\n    this.handleInput = e => {\n      this.setState({\n        devis: e.target.files[0]\n      });\n      console.log(\"devis\", e.target.files[0].name);\n    };\n\n    this.upload = e => {\n      const formData = new FormData();\n      formData.append(\"devis\", this.state.devis);\n      axios.post(\"http://localhost:8000/\", formData).then(res => {\n        console.log(this.state.devis.name);\n      });\n    };\n\n    this.page = (page, pageSize) => {\n      this.setState({\n        page: page,\n        pageSize: pageSize\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.props.getAideFromDB();\n    this.props.getReservation();\n    this.props.getUser();\n  }\n  /********************** upload devis ******************* */\n\n\n  render() {\n    //  ne donner l'accès pour ce component qu'à l'admin!\n    if (this.props.user.role !== \"Admin\") {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 14\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"liste-reservation\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"titre-tab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }\n    }, \"Gestion des r\\xE9servations\"), /*#__PURE__*/React.createElement(Table, {\n      celled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Table.Header, {\n      className: \"table-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Table.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      className: \"title-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 15\n      }\n    }, \"Nom-Pr\\xE9nom-client\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      className: \"title-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 15\n      }\n    }, \"Nom-Pr\\xE9nom-aide\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 15\n      }\n    }, \"Num-T\\xE9l\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 15\n      }\n    }, \"Adresse\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 15\n      }\n    }, \"Date-r\\xE9servation\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 15\n      }\n    }, \"D\\xE9lais\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 15\n      }\n    }, \"Devis\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 15\n      }\n    }, \"Actions\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 15\n      }\n    }, \" D\\xE9cision\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 15\n      }\n    }, \" Paiement\"), /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 15\n      }\n    }, \" Validation d\\xE9finitive\"))), /*#__PURE__*/React.createElement(Table.Body, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }\n    }, this.props.reservation.filter(el => el.decision !== \"Annulée\") ///////////////// PAGINATION //////////////////////////\n    .filter((l, index) => (this.state.page - 1) * this.state.pageSize <= index && index < this.state.page * this.state.pageSize).map((el, i) => /*#__PURE__*/React.createElement(Table.Row, {\n      className: el.decision == \"Validée\" ? \"redadminbb\" : \"f\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      ribbon: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }\n    }, el.client.nom_prenom)), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      ribbon: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }\n    }, el.aide.nom_prenom)), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 19\n      }\n    }, el.tel_client), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 19\n      }\n    }, el.adresse_client), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 19\n      }\n    }, el.date_end, \" \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 35\n      }\n    }), el.date_start), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 19\n      }\n    }, \" \", moment(el.date_end, \"YYYYMMDD\").fromNow()), /*#__PURE__*/React.createElement(Table.Cell, {\n      className: \"pos-Action \",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 19\n      }\n    }, el.decision !== \"Annulée\" ? el.decision === \"En attente\" ? /*#__PURE__*/React.createElement(MDBInput, {\n      type: \"file\",\n      onChange: e => this.handleInput(e),\n      outline: true,\n      style: {\n        width: \"160px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 25\n      }\n    }) : \"Envoyé\" : \"anuller\"), /*#__PURE__*/React.createElement(Table.Cell, {\n      className: \"action-button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"valider-button\",\n      outline: true,\n      size: \"sm\",\n      onClick: () => (this.upload(), this.props.editDecisionInDB({\n        _id: el._id,\n        decision: this.state.decision,\n        devis: this.state.devis.name\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      class: \"fas fa-check-square valider but-confirm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 23\n      }\n    }))), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 19\n      }\n    }, \" \", el.decision === \"Validée\" ? /*#__PURE__*/React.createElement(\"img\", {\n      src: \"http://localhost:8000/\" + el.devis,\n      width: \"50px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 23\n      }\n    }) : el.decision), /*#__PURE__*/React.createElement(Table.Cell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 19\n      }\n    }, el.paiement ? /*#__PURE__*/React.createElement(\"a\", {\n      href: `http://localhost:8000/${el.paiement}`,\n      target: \"_blanck\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 23\n      }\n    }, \"Paiement\") : \"pas encore\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"but-validation-d\\xE9finitive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Table.Cell, {\n      className: \"action-button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      className: \"valider-button\",\n      outline: true,\n      size: \"sm\",\n      onClick: () => (this.upload(), this.props.editDecisionInDB({\n        _id: el._id,\n        decision: \"Validée définitive\"\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      class: \"fas fa-check-square valider but-confirm\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(Button, {\n      className: \"annuler-button\",\n      outline: true,\n      size: \"sm\",\n      onClick: () => this.props.editDecisionInDB({\n        _id: el._id,\n        decision: this.state.deci\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      class: \"fas fa-trash annuler but-annul\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 25\n      }\n    })))))), \" \"), /*#__PURE__*/React.createElement(Table.Footer, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Table.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Table.HeaderCell, {\n      colSpan: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 15\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"pagination\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Pagination, {\n      defaultCurrent: 1,\n      pageSize: 3,\n      onChange: this.page,\n      total: this.props.aides.length,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    aides: state.aides,\n    reservation: state.reservation,\n    user: state.auth\n  };\n};\n\nexport default connect(mapStateToProps, {\n  getAideFromDB,\n  getReservation,\n  getUser,\n  editDecisionInDB\n})(GestionReserv);","map":{"version":3,"sources":["/home/amira/Bureau/copie-projet-chef-d-oeuvreV12/client/src/components/dashbordAdmin/gestion-admin.js"],"names":["React","Component","connect","getAideFromDB","Pagination","moment","Redirect","getReservation","editDecisionInDB","getUser","Label","Table","Button","MDBInput","axios","GestionReserv","state","decision","deci","devis","page","pageSize","handleInput","e","setState","target","files","console","log","name","upload","formData","FormData","append","post","then","res","componentDidMount","props","render","user","role","reservation","filter","el","l","index","map","i","client","nom_prenom","aide","tel_client","adresse_client","date_end","date_start","fromNow","width","_id","paiement","aides","length","mapStateToProps","auth"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,aAAT,QAA8B,iCAA9B;AACA,SAASC,UAAT,QAA2B,MAA3B;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAASC,QAAT,QAAyB,kBAAzB;AAEA,SACEC,cADF,EAEEC,gBAFF,QAGO,iCAHP;AAIA,SAASC,OAAT,QAAwB,oBAAxB;AACA,SAASC,KAAT,EAAgBC,KAAhB,EAAuBC,MAAvB,QAAqC,mBAArC;AACA,SAASC,QAAT,QAAyB,UAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,aAAN,SAA4Bd,SAA5B,CAAsC;AAAA;AAAA;AAAA,SAC3Ce,KAD2C,GACnC;AACNC,MAAAA,QAAQ,EAAE,SADJ;AAENC,MAAAA,IAAI,EAAE,SAFA;AAGNC,MAAAA,KAAK,EAAE,EAHD;AAINC,MAAAA,IAAI,EAAE,CAJA;AAKNC,MAAAA,QAAQ,EAAE;AALJ,KADmC;;AAAA,SAc3CC,WAd2C,GAc5BC,CAAD,IAAO;AACnB,WAAKC,QAAL,CAAc;AAAEL,QAAAA,KAAK,EAAEI,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf;AAAT,OAAd;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBL,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,EAAkBG,IAAvC;AACD,KAjB0C;;AAAA,SAmB3CC,MAnB2C,GAmBjCP,CAAD,IAAO;AACd,YAAMQ,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,MAAAA,QAAQ,CAACE,MAAT,CAAgB,OAAhB,EAAyB,KAAKjB,KAAL,CAAWG,KAApC;AACAL,MAAAA,KAAK,CAACoB,IAAN,CAAW,wBAAX,EAAqCH,QAArC,EAA+CI,IAA/C,CAAqDC,GAAD,IAAS;AAC3DT,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKZ,KAAL,CAAWG,KAAX,CAAiBU,IAA7B;AACD,OAFD;AAGD,KAzB0C;;AAAA,SA4B3CT,IA5B2C,GA4BpC,CAACA,IAAD,EAAOC,QAAP,KAAoB;AACzB,WAAKG,QAAL,CAAc;AAAEJ,QAAAA,IAAI,EAAEA,IAAR;AAAcC,QAAAA,QAAQ,EAAEA;AAAxB,OAAd;AACD,KA9B0C;AAAA;;AAQ3CgB,EAAAA,iBAAiB,GAAG;AAClB,SAAKC,KAAL,CAAWnC,aAAX;AACA,SAAKmC,KAAL,CAAW/B,cAAX;AACA,SAAK+B,KAAL,CAAW7B,OAAX;AACD;AACD;;;AAkBA8B,EAAAA,MAAM,GAAG;AACP;AAEA,QAAI,KAAKD,KAAL,CAAWE,IAAX,CAAgBC,IAAhB,KAAyB,OAA7B,EAAsC;AACpC,0BAAO,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACD;;AACD,wBACE;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAI,MAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCADF,eAEE,oBAAC,KAAD;AAAO,MAAA,MAAM,MAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD,CAAO,MAAP;AAAc,MAAA,SAAS,EAAC,cAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD,CAAO,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD,CAAO,UAAP;AAAkB,MAAA,SAAS,EAAC,cAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BADF,eAIE,oBAAC,KAAD,CAAO,UAAP;AAAkB,MAAA,SAAS,EAAC,cAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAJF,eAOE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAPF,eASE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBATF,eAUE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAVF,eAYE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAZF,eAcE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAdF,eAeE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAfF,eAiBE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAjBF,eAkBE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAlBF,eAmBE,oBAAC,KAAD,CAAO,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAnBF,CADF,CADF,eAyBE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKH,KAAL,CAAWI,WAAX,CACEC,MADF,CACUC,EAAD,IAAQA,EAAE,CAAC3B,QAAH,KAAgB,SADjC,EAEC;AAFD,KAGE0B,MAHF,CAIG,CAACE,CAAD,EAAIC,KAAJ,KACE,CAAC,KAAK9B,KAAL,CAAWI,IAAX,GAAkB,CAAnB,IAAwB,KAAKJ,KAAL,CAAWK,QAAnC,IAA+CyB,KAA/C,IACAA,KAAK,GAAG,KAAK9B,KAAL,CAAWI,IAAX,GAAkB,KAAKJ,KAAL,CAAWK,QAN1C,EAQE0B,GARF,CAQM,CAACH,EAAD,EAAKI,CAAL,kBACH,oBAAC,KAAD,CAAO,GAAP;AACE,MAAA,SAAS,EAAEJ,EAAE,CAAC3B,QAAH,IAAe,SAAf,GAA2B,YAA3B,GAA0C,GADvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAGE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD;AAAO,MAAA,MAAM,MAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAe2B,EAAE,CAACK,MAAH,CAAUC,UAAzB,CADF,CAHF,eAME,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD;AAAO,MAAA,MAAM,MAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAeN,EAAE,CAACO,IAAH,CAAQD,UAAvB,CADF,CANF,eASE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAaN,EAAE,CAACQ,UAAhB,CATF,eAWE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAaR,EAAE,CAACS,cAAhB,CAXF,eAYE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGT,EAAE,CAACU,QADN,oBACgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADhB,EAEGV,EAAE,CAACW,UAFN,CAZF,eAiBE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,GADH,EAEGlD,MAAM,CAACuC,EAAE,CAACU,QAAJ,EAAc,UAAd,CAAN,CAAgCE,OAAhC,EAFH,CAjBF,eAqBE,oBAAC,KAAD,CAAO,IAAP;AAAY,MAAA,SAAS,EAAC,aAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGZ,EAAE,CAAC3B,QAAH,KAAgB,SAAhB,GACC2B,EAAE,CAAC3B,QAAH,KAAgB,YAAhB,gBACE,oBAAC,QAAD;AACE,MAAA,IAAI,EAAC,MADP;AAEE,MAAA,QAAQ,EAAGM,CAAD,IAAO,KAAKD,WAAL,CAAiBC,CAAjB,CAFnB;AAGE,MAAA,OAAO,MAHT;AAIE,MAAA,KAAK,EAAE;AAAEkC,QAAAA,KAAK,EAAE;AAAT,OAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,GAQE,QATH,GAYC,SAbJ,CArBF,eAsCE,oBAAC,KAAD,CAAO,IAAP;AAAY,MAAA,SAAS,EAAC,eAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,MAAD;AACE,MAAA,SAAS,EAAC,gBADZ;AAEE,MAAA,OAAO,MAFT;AAGE,MAAA,IAAI,EAAC,IAHP;AAIE,MAAA,OAAO,EAAE,OACP,KAAK3B,MAAL,IACA,KAAKQ,KAAL,CAAW9B,gBAAX,CAA4B;AAC1BkD,QAAAA,GAAG,EAAEd,EAAE,CAACc,GADkB;AAE1BzC,QAAAA,QAAQ,EAAE,KAAKD,KAAL,CAAWC,QAFK;AAG1BE,QAAAA,KAAK,EAAE,KAAKH,KAAL,CAAWG,KAAX,CAAiBU;AAHE,OAA5B,CAFO,CAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAaE;AAAG,MAAA,KAAK,EAAC,yCAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAbF,CADF,CAtCF,eAwDE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,GADH,EAEGe,EAAE,CAAC3B,QAAH,KAAgB,SAAhB,gBACC;AACE,MAAA,GAAG,EAAE,2BAA2B2B,EAAE,CAACzB,KADrC;AAEE,MAAA,KAAK,EAAC,MAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,GAMCyB,EAAE,CAAC3B,QARP,CAxDF,eAmEE,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG2B,EAAE,CAACe,QAAH,gBACC;AACE,MAAA,IAAI,EAAG,yBAAwBf,EAAE,CAACe,QAAS,EAD7C;AAEE,MAAA,MAAM,EAAC,SAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADD,GAQC,YATJ,CAnEF,eA+EE;AAAK,MAAA,SAAS,EAAC,8BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD,CAAO,IAAP;AAAY,MAAA,SAAS,EAAC,eAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,MAAD;AACE,MAAA,SAAS,EAAC,gBADZ;AAEE,MAAA,OAAO,MAFT;AAGE,MAAA,IAAI,EAAC,IAHP;AAIE,MAAA,OAAO,EAAE,OACP,KAAK7B,MAAL,IACA,KAAKQ,KAAL,CAAW9B,gBAAX,CAA4B;AAC1BkD,QAAAA,GAAG,EAAEd,EAAE,CAACc,GADkB;AAE1BzC,QAAAA,QAAQ,EAAE;AAFgB,OAA5B,CAFO,CAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAYE;AAAG,MAAA,KAAK,EAAC,yCAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZF,CADF,eAgBE,oBAAC,MAAD;AACE,MAAA,SAAS,EAAC,gBADZ;AAEE,MAAA,OAAO,MAFT;AAGE,MAAA,IAAI,EAAC,IAHP;AAIE,MAAA,OAAO,EAAE,MACP,KAAKqB,KAAL,CAAW9B,gBAAX,CAA4B;AAC1BkD,QAAAA,GAAG,EAAEd,EAAE,CAACc,GADkB;AAE1BzC,QAAAA,QAAQ,EAAE,KAAKD,KAAL,CAAWE;AAFK,OAA5B,CALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAWE;AAAG,MAAA,KAAK,EAAC,gCAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXF,CAhBF,CADF,CA/EF,CATH,CADH,EA0HQ,GA1HR,CAzBF,eAsJE,oBAAC,KAAD,CAAO,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD,CAAO,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD,CAAO,UAAP;AAAkB,MAAA,OAAO,EAAC,GAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CAtJF,CAFF,eA+JE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,UAAD;AACE,MAAA,cAAc,EAAE,CADlB;AAEE,MAAA,QAAQ,EAAE,CAFZ;AAGE,MAAA,QAAQ,EAAE,KAAKE,IAHjB;AAIE,MAAA,KAAK,EAAE,KAAKkB,KAAL,CAAWsB,KAAX,CAAiBC,MAJ1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CA/JF,CADF;AA0KD;;AA/M0C;;AAiN7C,MAAMC,eAAe,GAAI9C,KAAD,IAAW;AACjC,SAAO;AACL4C,IAAAA,KAAK,EAAE5C,KAAK,CAAC4C,KADR;AAELlB,IAAAA,WAAW,EAAE1B,KAAK,CAAC0B,WAFd;AAGLF,IAAAA,IAAI,EAAExB,KAAK,CAAC+C;AAHP,GAAP;AAKD,CAND;;AAOA,eAAe7D,OAAO,CAAC4D,eAAD,EAAkB;AACtC3D,EAAAA,aADsC;AAEtCI,EAAAA,cAFsC;AAGtCE,EAAAA,OAHsC;AAItCD,EAAAA;AAJsC,CAAlB,CAAP,CAKZO,aALY,CAAf","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { getAideFromDB } from \"../../actions/aideActionCreator\";\nimport { Pagination } from \"antd\";\nimport moment from \"moment\";\nimport { Redirect } from \"react-router-dom\";\n\nimport {\n  getReservation,\n  editDecisionInDB,\n} from \"../../actions/reservationAction\";\nimport { getUser } from \"../../actions/auth\";\nimport { Label, Table, Button } from \"semantic-ui-react\";\nimport { MDBInput } from \"mdbreact\";\nimport axios from \"axios\";\n\nexport class GestionReserv extends Component {\n  state = {\n    decision: \"Validée\",\n    deci: \"Annulée\",\n    devis: \"\",\n    page: 1,\n    pageSize: 3,\n  };\n  componentDidMount() {\n    this.props.getAideFromDB();\n    this.props.getReservation();\n    this.props.getUser();\n  }\n  /********************** upload devis ******************* */\n  handleInput = (e) => {\n    this.setState({ devis: e.target.files[0] });\n    console.log(\"devis\", e.target.files[0].name);\n  };\n\n  upload = (e) => {\n    const formData = new FormData();\n    formData.append(\"devis\", this.state.devis);\n    axios.post(\"http://localhost:8000/\", formData).then((res) => {\n      console.log(this.state.devis.name);\n    });\n  };\n  // handle pagination\n\n  page = (page, pageSize) => {\n    this.setState({ page: page, pageSize: pageSize });\n  };\n  render() {\n    //  ne donner l'accès pour ce component qu'à l'admin!\n\n    if (this.props.user.role !== \"Admin\") {\n      return <Redirect to=\"/\" />;\n    }\n    return (\n      <div className=\"liste-reservation\">\n        <h1 className=\"titre-tab\">Gestion des réservations</h1>\n        <Table celled>\n          <Table.Header className=\"table-header\">\n            <Table.Row>\n              <Table.HeaderCell className=\"title-header\">\n                Nom-Prénom-client\n              </Table.HeaderCell>\n              <Table.HeaderCell className=\"title-header\">\n                Nom-Prénom-aide\n              </Table.HeaderCell>\n              <Table.HeaderCell>Num-Tél</Table.HeaderCell>\n\n              <Table.HeaderCell>Adresse</Table.HeaderCell>\n              <Table.HeaderCell>Date-réservation</Table.HeaderCell>\n\n              <Table.HeaderCell>Délais</Table.HeaderCell>\n\n              <Table.HeaderCell>Devis</Table.HeaderCell>\n              <Table.HeaderCell>Actions</Table.HeaderCell>\n\n              <Table.HeaderCell> Décision</Table.HeaderCell>\n              <Table.HeaderCell> Paiement</Table.HeaderCell>\n              <Table.HeaderCell> Validation définitive</Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n\n          <Table.Body>\n            {this.props.reservation\n              .filter((el) => el.decision !== \"Annulée\")\n              ///////////////// PAGINATION //////////////////////////\n              .filter(\n                (l, index) =>\n                  (this.state.page - 1) * this.state.pageSize <= index &&\n                  index < this.state.page * this.state.pageSize\n              )\n              .map((el, i) => (\n                <Table.Row\n                  className={el.decision == \"Validée\" ? \"redadminbb\" : \"f\"}\n                >\n                  <Table.Cell>\n                    <Label ribbon>{el.client.nom_prenom}</Label>\n                  </Table.Cell>\n                  <Table.Cell>\n                    <Label ribbon>{el.aide.nom_prenom}</Label>\n                  </Table.Cell>\n                  <Table.Cell>{el.tel_client}</Table.Cell>\n\n                  <Table.Cell>{el.adresse_client}</Table.Cell>\n                  <Table.Cell>\n                    {el.date_end} <br></br>\n                    {el.date_start}\n                  </Table.Cell>\n\n                  <Table.Cell>\n                    {\" \"}\n                    {moment(el.date_end, \"YYYYMMDD\").fromNow()}\n                  </Table.Cell>\n                  <Table.Cell className=\"pos-Action \">\n                    {el.decision !== \"Annulée\" ? (\n                      el.decision === \"En attente\" ? (\n                        <MDBInput\n                          type=\"file\"\n                          onChange={(e) => this.handleInput(e)}\n                          outline\n                          style={{ width: \"160px\" }}\n                        />\n                      ) : (\n                        \"Envoyé\"\n                      )\n                    ) : (\n                      \"anuller\"\n                    )}\n                  </Table.Cell>\n\n                  <Table.Cell className=\"action-button\">\n                    <Button\n                      className=\"valider-button\"\n                      outline\n                      size=\"sm\"\n                      onClick={() => (\n                        this.upload(),\n                        this.props.editDecisionInDB({\n                          _id: el._id,\n                          decision: this.state.decision,\n                          devis: this.state.devis.name,\n                        })\n                      )}\n                    >\n                      <i class=\"fas fa-check-square valider but-confirm\"></i>\n                    </Button>\n                  </Table.Cell>\n\n                  <Table.Cell>\n                    {\" \"}\n                    {el.decision === \"Validée\" ? (\n                      <img\n                        src={\"http://localhost:8000/\" + el.devis}\n                        width=\"50px\"\n                      />\n                    ) : (\n                      el.decision\n                    )}\n                  </Table.Cell>\n                  <Table.Cell>\n                    {el.paiement ? (\n                      <a\n                        href={`http://localhost:8000/${el.paiement}`}\n                        target=\"_blanck\"\n                      >\n                        Paiement\n                      </a>\n                    ) : (\n                      \"pas encore\"\n                    )}\n                  </Table.Cell>\n                  <div className=\"but-validation-définitive\">\n                    <Table.Cell className=\"action-button\">\n                      <Button\n                        className=\"valider-button\"\n                        outline\n                        size=\"sm\"\n                        onClick={() => (\n                          this.upload(),\n                          this.props.editDecisionInDB({\n                            _id: el._id,\n                            decision: \"Validée définitive\",\n                          })\n                        )}\n                      >\n                        <i class=\"fas fa-check-square valider but-confirm\"></i>\n                      </Button>\n\n                      <Button\n                        className=\"annuler-button\"\n                        outline\n                        size=\"sm\"\n                        onClick={() =>\n                          this.props.editDecisionInDB({\n                            _id: el._id,\n                            decision: this.state.deci,\n                          })\n                        }\n                      >\n                        <i class=\"fas fa-trash annuler but-annul\"></i>\n                      </Button>\n                    </Table.Cell>\n                  </div>\n                </Table.Row>\n              ))}{\" \"}\n          </Table.Body>\n\n          <Table.Footer>\n            <Table.Row>\n              <Table.HeaderCell colSpan=\"3\"></Table.HeaderCell>\n            </Table.Row>\n          </Table.Footer>\n        </Table>\n        {/************************** * PAGINATION *********************/}\n        <div className=\"pagination\">\n          <Pagination\n            defaultCurrent={1}\n            pageSize={3}\n            onChange={this.page}\n            total={this.props.aides.length}\n          />\n        </div>\n      </div>\n    );\n  }\n}\nconst mapStateToProps = (state) => {\n  return {\n    aides: state.aides,\n    reservation: state.reservation,\n    user: state.auth,\n  };\n};\nexport default connect(mapStateToProps, {\n  getAideFromDB,\n  getReservation,\n  getUser,\n  editDecisionInDB,\n})(GestionReserv);\n"]},"metadata":{},"sourceType":"module"}